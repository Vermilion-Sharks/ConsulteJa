generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model cj_apis {
  id               String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  api_key          String     @unique @db.VarChar(64)
  ativa            Boolean    @default(true)
  usuario_id       String     @db.Uuid
  data_criacao     DateTime   @default(now()) @db.Timestamptz(6)
  data_atualizacao DateTime   @updatedAt @db.Timestamptz(6)
  data_desativacao DateTime?  @db.Timestamptz(6)
  ultimo_uso       DateTime?  @db.Timestamptz(6)
  users            users      @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  produtos         produtos[]
}

model produtos {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  codigo           String   @db.VarChar(13)
  nome             String   @db.VarChar(100)
  marca            String   @db.VarChar(70)
  descricao        String   @db.VarChar(300)
  preco            Decimal  @db.Decimal(10, 2)
  imagem           String?  @db.VarChar(255)
  importado        Boolean  @default(false)
  api_id           String   @db.Uuid
  data_criacao     DateTime @default(now()) @db.Timestamptz(6)
  data_atualizacao DateTime @updatedAt @db.Timestamptz(6)
  cj_apis          cj_apis  @relation(fields: [api_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([api_id, codigo])
}

model users {
  id            String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String     @db.VarChar(100)
  email         String     @unique @db.VarChar(254)
  password      String     @db.VarChar(255)
  token_version Int        @default(1)
  created_at    DateTime   @default(now()) @db.Timestamptz(6)
  updated_at    DateTime   @updatedAt @db.Timestamptz(6)
  sessions      sessions[]
  cj_apis       cj_apis[]
}

model sessions {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id     String   @db.Uuid
  token       String   @unique @db.VarChar(64)
  session_id  String   @unique @db.Uuid
  remember_me Boolean  @default(false)
  device_name String   @db.VarChar(100)
  device_hash String   @db.VarChar(64)
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  expires_in  DateTime @db.Timestamptz(6)
  users       users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}
